!pip install numpy==1.24.4
!pip install scikit-surprise
from surprise import Dataset, Reader, SVD
from surprise.model_selection import cross_validate
data = Dataset.load_builtin('ml-100k')
import pandas as pd

df = pd.DataFrame({
    'userID': ['A', 'B', 'A', 'B', 'C'],
    'itemID': ['X', 'X', 'Y', 'Y', 'X'],
    'rating': [4, 5, 3, 2, 4]
})

reader = Reader(rating_scale=(1, 5))
data = Dataset.load_from_df(df[['userID', 'itemID', 'rating']], reader)
algo = SVD()  # Matrix Factorization technique
cross_validate(algo, data, measures=['RMSE', 'MAE'], cv=3, verbose=True)

trainset = data.build_full_trainset()
algo.fit(trainset)

prediction = algo.predict('A', 'Y')
print(prediction)
